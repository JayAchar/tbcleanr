<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cleaning workflow - admission file â€¢ tbcleanr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Cleaning workflow - admission file">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-128985004-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-128985004-1');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tbcleanr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.3.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/getting-started.html">Getting started</a>
    </li>
    <li>
      <a href="../articles/admission-file-workflow.html">Workflow - admission</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../news/index.html">Changelog</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/JayAchar/tbcleanr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Cleaning workflow - admission file</h1>
                        <h4 class="author">Jay Achar</h4>
            
            <h4 class="date">2019-05-25</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/JayAchar/tbcleanr/blob/master/vignettes/admission-file-workflow.Rmd"><code>vignettes/admission-file-workflow.Rmd</code></a></small>
      <div class="hidden name"><code>admission-file-workflow.Rmd</code></div>

    </div>

    
    
<p>The <code>tbcleanr</code> package has been designed to simplify routine data cleaning for TB programmatic data. Since this data is typically stored in Excel, CSV or TSV formatted files, the chosen workflow for the package retains this seperation to allow easier calculation and generation of new variables in the <code>tbgeneratr</code> package. In this vignette, a typical workflow for cleaning admission data files is presented.</p>
<div id="import-data" class="section level2">
<h2 class="hasAnchor">
<a href="#import-data" class="anchor"></a>Import data</h2>
<p>Use of the <code>readr</code> package is recommended for importing CSV and TSV files. While the <code>readxl</code> package can be used for data stored in Excel documents, this is not recommended.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># define working directory</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/getwd">setwd</a></span>(<span class="st">"C:/tb_data"</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co"># confirm required admission file is present</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list.files">list.files</a></span>()</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co"># read in admission data</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8">adm &lt;-<span class="st"> </span>readr<span class="op">::</span><span class="kw">read_csv</span>(<span class="st">"admission_tb_data.csv"</span>, <span class="dt">guess_max =</span> <span class="dv">100000</span>)</a></code></pre></div>
<p>The <code>guess_max</code> option is defined here to ensure variables are parsed using a greater than standard figure. Since some variables have been added to data sets only in recent years, if this option is not defined, there is a risk that recently collected data will be incorrectly lost through misclassification of a variable as a logical vector. For larger data sets, higher figures for <code>guess_max</code> are recommended.</p>
<p>Check for warnings in the output of the <code>read_csv()</code> call. If a variable has been incorrectly defined as a logical, parsing failures will be displayed.</p>
</div>
<div id="simplified-workflow" class="section level2">
<h2 class="hasAnchor">
<a href="#simplified-workflow" class="anchor"></a>Simplified workflow</h2>
<p>All <code>tbcleanr</code> functions designed to work with admission data files can be applied using one function call:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">clean_adm &lt;-<span class="st"> </span><span class="kw">adm_data_cleanr</span>(adm)</a></code></pre></div>
<p>Individual functions can also be called seperately where more specific cleaning is required.</p>
</div>
<div id="multiple-files" class="section level2">
<h2 class="hasAnchor">
<a href="#multiple-files" class="anchor"></a>Multiple files</h2>
<p>Sometimes cleaning and subsequent analysis of multiple data sets is required. This can be achieved by combining the <code>tbcleanr</code> and <code>tbgeneratr</code> packages with <code>purrr</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># define files to process</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2">filenames &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"admission1.csv"</span>, <span class="st">"admission2.csv"</span>, <span class="st">"admission3.csv"</span>)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co"># combine purrr with tbcleanr</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5">tbl &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/reexports.html">tibble</a></span>(<span class="dt">file =</span> filenames,</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">                     <span class="dt">adm_data =</span> <span class="kw">map</span>(<span class="dt">.x =</span> filenames, </a>
<a class="sourceLine" id="cb3-7" data-line-number="7">                                  <span class="dt">.f =</span> <span class="op">~</span><span class="st"> </span>{readr<span class="op">::</span><span class="kw">read_csv</span>(.x,</a>
<a class="sourceLine" id="cb3-8" data-line-number="8">                                                          <span class="dt">guess_max =</span> <span class="dv">100000</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="st">                                      </span>tbcleanr<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/tbcleanr/topics/adm_data_cleanr">adm_data_cleanr</a></span>()}))</a></code></pre></div>
<p>This approach uses <code>map()</code> to iterate over the defined file names in the working directory. The defined function within <code>map()</code> imports the file and applies the <code>adm_data_cleanr()</code> leaving a cleaned, nested dataset in the tibble. Further use of <code>map()</code> will allow additional processing using the <code>tbgeneratr</code> package.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#import-data">Import data</a></li>
      <li><a href="#simplified-workflow">Simplified workflow</a></li>
      <li><a href="#multiple-files">Multiple files</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Jay Achar.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
